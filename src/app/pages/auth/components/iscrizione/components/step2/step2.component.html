<div class="card shadow-lg border-0" style="overflow: hidden">
  <div
    class="card-header text-white text-center"
    style="background: linear-gradient(90deg, #0d6efd, #0b5ed7)"
  >
    <h5 class="card-title mb-0">Modulo di Aggiornamento Profilo</h5>
  </div>

  <div class="card-body p-4" style="background-color: #f8f9fa">
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
      <!-- Nome Utente -->
      <div class="mb-4">
        <label for="nomeUtente" class="form-label fw-semibold"
          >Nome Utente</label
        >
        <input
          type="text"
          id="nomeUtente"
          class="form-control form-control-lg border-0 shadow-sm"
          style="background-color: #e9ecef"
          [value]="nomeUtente"
          readonly
        />
      </div>

      <!-- Email -->
      <div class="mb-4">
        <label for="email" class="form-label fw-semibold">Email</label>
        <input
          type="email"
          id="email"
          class="form-control form-control-lg border-0 shadow-sm"
          style="background-color: #e9ecef"
          [value]="email"
          readonly
        />
      </div>

      <!-- Team -->
      <div class="mb-4">
        <label class="form-label fw-semibold">Team</label>
        <div
          id="squadra"
          class="p-3 rounded shadow-sm"
          [class]="{
            'border border-danger':
              ((f['squadra'].touched && f['squadra'].invalid) ||
                pulsantePremuto) &&
              f['squadra'].invalid,
            'border border-success': pulsantePremuto && f['squadra'].valid
          }"
          style="background-color: #e7f3fe"
        >
          @for (t of team; track $index) {
          <div class="form-check mb-2">
            <input
              type="checkbox"
              [id]="'squadra-' + $index"
              class="form-check-input"
              [value]="t"
              [checked]="profileForm.get('squadra')?.value?.includes(t)"
              (change)="onTeamChange($event)"
            />
            <label [for]="'squadra-' + $index" class="form-check-label">
              {{ t }}
            </label>
          </div>
          }
        </div>

        @if (((f['squadra'].touched && f['squadra'].invalid) || pulsantePremuto)
        && f['squadra'].invalid) {
        <div class="invalid-feedback d-block mt-1">Il team è obbligatorio.</div>
        } @if (pulsantePremuto && f['squadra'].valid) {
        <div class="valid-feedback d-block mt-1">Selezione valida!</div>
        }
      </div>

      <!-- Stato -->
      <div class="mb-4">
        <label for="stato" class="form-label fw-semibold">Stato</label>
        <select
          id="stato"
          class="form-select form-select-lg border-0 shadow-sm"
          style="background-color: #e7f3fe"
          formControlName="stato"
          [class]="{
            'is-invalid':
              ((f['stato'].touched && f['stato'].invalid) || pulsantePremuto) &&
              f['stato'].invalid,
            'is-valid': pulsantePremuto && f['stato'].valid
          }"
        >
          @for (stato of statiPersona; track $index) {
          <option [value]="stato">{{ stato }}</option>
          }
        </select>

        @if ((f['stato'].touched && f['stato'].invalid) || pulsantePremuto) {
        <div class="invalid-feedback">Lo stato è obbligatorio.</div>
        } @if (pulsantePremuto && f['stato'].valid) {
        <div class="valid-feedback">Campo valido!</div>
        }
      </div>

      <div class="row mb-4">
        <!-- Regione -->
        <div class="col-md-6 mb-3 mb-md-0">
          <label for="regione" class="form-label fw-semibold">Regione</label>
          <select
            id="regione"
            class="form-select form-select-lg border-0 shadow-sm"
            style="background-color: #e7f3fe"
            formControlName="regione"
            (change)="onRegioneChange($event)"
            [class]="{
              'is-invalid':
                ((f['regione'].touched && f['regione'].invalid) ||
                  pulsantePremuto) &&
                f['regione'].invalid,
              'is-valid': pulsantePremuto && f['regione'].valid
            }"
          >
            @for (regione of regioni; track regione.codice) {
            <option [value]="regione.codice">{{ regione.nome }}</option>
            }
          </select>

          @if (((f['regione'].touched && f['regione'].invalid) ||
          pulsantePremuto) && f['regione'].invalid) {
          <div class="invalid-feedback">La regione è obbligatoria.</div>
          } @if (pulsantePremuto && f['regione'].valid) {
          <div class="valid-feedback">Regione selezionata correttamente!</div>
          }
        </div>

        <!-- Provincia -->
        <div class="col-md-6">
          <label for="provincia" class="form-label fw-semibold"
            >Provincia</label
          >
          <select
            id="provincia"
            class="form-select form-select-lg border-0 shadow-sm"
            style="background-color: #e7f3fe"
            formControlName="provincia"
            [disabled]="f['regione'].invalid"
            [class]="{
              'is-invalid':
                ((f['provincia'].touched && f['provincia'].invalid) ||
                  pulsantePremuto) &&
                f['provincia'].invalid,
              'is-valid': pulsantePremuto && f['provincia'].valid
            }"
          >
            @for (provincia of province; track provincia.codice) {
            <option [value]="provincia.nome">{{ provincia.nome }}</option>
            }
          </select>

          @if (((f['provincia'].touched && f['provincia'].invalid) ||
          pulsantePremuto) && f['provincia'].invalid) {
          <div class="invalid-feedback">La provincia è obbligatoria.</div>
          } @if (pulsantePremuto && f['provincia'].valid) {
          <div class="valid-feedback">Provincia selezionata correttamente!</div>
          }
        </div>
      </div>
    </form>
  </div>
</div>
